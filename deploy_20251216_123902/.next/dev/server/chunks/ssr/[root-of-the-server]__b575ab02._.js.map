{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 26, "column": 0}, "map": {"version":3,"sources":["file:///E:/lyra-app-v3/src/lib/supabase/server.ts"],"sourcesContent":["import { createServerClient } from '@supabase/ssr';\r\nimport { cookies } from 'next/headers';\r\n\r\nexport async function createClient() {\r\n  const cookieStore = await cookies();\r\n\r\n  return createServerClient(\r\n    process.env.NEXT_PUBLIC_SUPABASE_URL!,\r\n    process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!,\r\n    {\r\n      cookies: {\r\n        getAll() {\r\n          return cookieStore.getAll();\r\n        },\r\n        setAll(cookiesToSet) {\r\n          try {\r\n            cookiesToSet.forEach(({ name, value, options }) =>\r\n              cookieStore.set(name, value, options)\r\n            );\r\n          } catch {\r\n            // Server Component - cookies().set() will fail\r\n          }\r\n        },\r\n      },\r\n    }\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;AAAA;AACA;;;AAEO,eAAe;IACpB,MAAM,cAAc,MAAM,IAAA,0IAAO;IAEjC,OAAO,IAAA,+LAAkB,sUAGvB;QACE,SAAS;YACP;gBACE,OAAO,YAAY,MAAM;YAC3B;YACA,QAAO,YAAY;gBACjB,IAAI;oBACF,aAAa,OAAO,CAAC,CAAC,EAAE,IAAI,EAAE,KAAK,EAAE,OAAO,EAAE,GAC5C,YAAY,GAAG,CAAC,MAAM,OAAO;gBAEjC,EAAE,OAAM;gBACN,+CAA+C;gBACjD;YACF;QACF;IACF;AAEJ"}},
    {"offset": {"line": 56, "column": 0}, "map": {"version":3,"sources":["file:///E:/lyra-app-v3/src/components/PaymentForm.tsx/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/src/components/PaymentForm.tsx <module evaluation> from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/components/PaymentForm.tsx <module evaluation>\",\n    \"default\",\n);\n"],"names":[],"mappings":"AAAA,uEAAuE;;;;;AACvE;;uCACe,IAAA,wQAAuB,EAClC;IAAa,MAAM,IAAI,MAAM;AAAkS,GAC/T,gEACA","ignoreList":[0]}},
    {"offset": {"line": 70, "column": 0}, "map": {"version":3,"sources":["file:///E:/lyra-app-v3/src/components/PaymentForm.tsx/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/src/components/PaymentForm.tsx from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/components/PaymentForm.tsx\",\n    \"default\",\n);\n"],"names":[],"mappings":"AAAA,uEAAuE;;;;;AACvE;;uCACe,IAAA,wQAAuB,EAClC;IAAa,MAAM,IAAI,MAAM;AAA8Q,GAC3S,4CACA","ignoreList":[0]}},
    {"offset": {"line": 84, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":""}},
    {"offset": {"line": 92, "column": 0}, "map": {"version":3,"sources":["file:///E:/lyra-app-v3/src/app/admin/billing/%5BinvoiceId%5D/pay/page.tsx"],"sourcesContent":["import { redirect } from 'next/navigation';\r\nimport { createClient } from '@/lib/supabase/server';\r\nimport { createClient as createServiceClient } from '@supabase/supabase-js';\r\nimport PaymentForm from '@/components/PaymentForm';\r\nimport Link from 'next/link';\r\nimport { ArrowLeft, CheckCircle2 } from 'lucide-react';\r\n\r\nexport default async function PaymentPage({ \r\n  params \r\n}: { \r\n  params: Promise<{ invoiceId: string }> \r\n}) {\r\n  const { invoiceId } = await params;\r\n  \r\n  const supabase = await createClient();\r\n  const { data: { user } } = await supabase.auth.getUser();\r\n  if (!user) redirect('/login');\r\n\r\n  const serviceSupabase = createServiceClient(\r\n    process.env.NEXT_PUBLIC_SUPABASE_URL!,\r\n    process.env.SUPABASE_SERVICE_ROLE_KEY!\r\n  );\r\n\r\n  const { data: invoice } = await serviceSupabase\r\n    .from('organization_invoices')\r\n    .select('*, organizations(name, contact_email)')\r\n    .eq('id', invoiceId)\r\n    .single();\r\n\r\n  if (!invoice) {\r\n    return (\r\n      <div className=\"min-h-screen bg-gray-50 py-12\">\r\n        <div className=\"max-w-2xl mx-auto px-4\">\r\n          <div className=\"bg-white rounded-xl shadow-sm p-8 text-center\">\r\n            <h1 className=\"text-2xl font-bold text-gray-900 mb-4\">Invoice Not Found</h1>\r\n            <p className=\"text-gray-600 mb-6\">The invoice you're looking for doesn't exist.</p>\r\n            <Link \r\n              href=\"/admin/billing\"\r\n              className=\"inline-flex items-center gap-2 text-blue-600 hover:text-blue-700\"\r\n            >\r\n              <ArrowLeft size={20} />\r\n              Back to Billing\r\n            </Link>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  // Check if already paid\r\n  if (invoice.status === 'paid' && invoice.amount_due_paisa === 0) {\r\n    return (\r\n      <div className=\"min-h-screen bg-gray-50 py-12\">\r\n        <div className=\"max-w-2xl mx-auto px-4\">\r\n          <div className=\"bg-white rounded-xl shadow-sm p-8\">\r\n            <div className=\"text-center mb-8\">\r\n              <div className=\"inline-flex items-center justify-center w-16 h-16 bg-green-100 rounded-full mb-4\">\r\n                <CheckCircle2 className=\"w-8 h-8 text-green-600\" />\r\n              </div>\r\n              <h1 className=\"text-2xl font-bold text-gray-900 mb-2\">Payment Complete</h1>\r\n              <p className=\"text-gray-600\">This invoice has been fully paid.</p>\r\n            </div>\r\n            \r\n            <div className=\"space-y-4 mb-8 border-t pt-6\">\r\n              <div className=\"flex justify-between\">\r\n                <span className=\"text-gray-600\">Invoice Number:</span>\r\n                <span className=\"font-semibold\">{invoice.invoice_number}</span>\r\n              </div>\r\n              <div className=\"flex justify-between\">\r\n                <span className=\"text-gray-600\">Organization:</span>\r\n                <span className=\"font-semibold\">{invoice.organizations.name}</span>\r\n              </div>\r\n              <div className=\"flex justify-between\">\r\n                <span className=\"text-gray-600\">Total Amount:</span>\r\n                <span className=\"font-semibold\">₹{(invoice.total_amount_paisa / 100).toFixed(2)}</span>\r\n              </div>\r\n              <div className=\"flex justify-between\">\r\n                <span className=\"text-gray-600\">Paid On:</span>\r\n                <span className=\"text-green-600\">\r\n                  {invoice.paid_at ? new Date(invoice.paid_at).toLocaleDateString() : 'N/A'}\r\n                </span>\r\n              </div>\r\n            </div>\r\n\r\n            <Link\r\n              href=\"/admin/billing\"\r\n              className=\"block w-full text-center bg-gray-100 text-gray-700 px-6 py-3 rounded-lg hover:bg-gray-200\"\r\n            >\r\n              Back to Billing\r\n            </Link>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  // Check if link is still valid (30 days from creation)\r\n  const createdAt = new Date(invoice.created_at);\r\n  const expiryDate = new Date(createdAt.getTime() + 30 * 24 * 60 * 60 * 1000);\r\n  const isExpired = new Date() > expiryDate;\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gray-50 py-12\">\r\n      <div className=\"max-w-2xl mx-auto px-4\">\r\n        <Link\r\n          href=\"/admin/billing\"\r\n          className=\"inline-flex items-center gap-2 text-gray-600 hover:text-gray-900 mb-6\"\r\n        >\r\n          <ArrowLeft size={20} />\r\n          Back to Billing\r\n        </Link>\r\n\r\n        <div className=\"bg-white rounded-xl shadow-sm p-8\">\r\n          <h1 className=\"text-2xl font-bold mb-6\">Pay Invoice</h1>\r\n          \r\n          <div className=\"space-y-4 mb-8\">\r\n            <div className=\"flex justify-between\">\r\n              <span className=\"text-gray-600\">Invoice Number:</span>\r\n              <span className=\"font-semibold\">{invoice.invoice_number}</span>\r\n            </div>\r\n            <div className=\"flex justify-between\">\r\n              <span className=\"text-gray-600\">Organization:</span>\r\n              <span className=\"font-semibold\">{invoice.organizations.name}</span>\r\n            </div>\r\n            <div className=\"flex justify-between\">\r\n              <span className=\"text-gray-600\">Period:</span>\r\n              <span className=\"font-semibold\">\r\n                {new Date(invoice.period_start).toLocaleDateString()} - {new Date(invoice.period_end).toLocaleDateString()}\r\n              </span>\r\n            </div>\r\n            <div className=\"flex justify-between\">\r\n              <span className=\"text-gray-600\">Total Amount:</span>\r\n              <span className=\"font-semibold\">₹{(invoice.total_amount_paisa / 100).toFixed(2)}</span>\r\n            </div>\r\n            {invoice.amount_paid_paisa > 0 && (\r\n              <div className=\"flex justify-between\">\r\n                <span className=\"text-gray-600\">Amount Paid:</span>\r\n                <span className=\"text-green-600\">₹{(invoice.amount_paid_paisa / 100).toFixed(2)}</span>\r\n              </div>\r\n            )}\r\n            <div className=\"flex justify-between text-lg border-t pt-4\">\r\n              <span className=\"font-semibold\">Amount Due:</span>\r\n              <span className=\"font-bold text-blue-600\">\r\n                ₹{(invoice.amount_due_paisa / 100).toFixed(2)}\r\n              </span>\r\n            </div>\r\n            <div className=\"flex justify-between text-sm\">\r\n              <span className=\"text-gray-600\">Payment Link Valid Until:</span>\r\n              <span className={isExpired ? 'text-red-600' : 'text-green-600'}>\r\n                {expiryDate.toLocaleDateString()}\r\n              </span>\r\n            </div>\r\n          </div>\r\n\r\n          {isExpired ? (\r\n            <div className=\"bg-red-50 border border-red-200 rounded-lg p-4 text-center\">\r\n              <p className=\"text-red-800 font-semibold mb-2\">Payment Link Expired</p>\r\n              <p className=\"text-red-600 text-sm\">\r\n                This payment link expired on {expiryDate.toLocaleDateString()}. \r\n                Please contact admin for a new payment link.\r\n              </p>\r\n            </div>\r\n          ) : (\r\n            <PaymentForm \r\n              invoiceId={invoice.id}\r\n              amount={invoice.amount_due_paisa}\r\n              invoiceNumber={invoice.invoice_number}\r\n              organizationName={invoice.organizations.name}\r\n            />\r\n          )}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}}]
}