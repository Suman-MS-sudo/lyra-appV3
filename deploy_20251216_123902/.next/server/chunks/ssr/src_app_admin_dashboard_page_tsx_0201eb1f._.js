module.exports=[84063,a=>{"use strict";var b=a.i(7997);a.i(70396);var c=a.i(73727),d=a.i(16349),e=a.i(51100),f=a.i(46840),g=a.i(83627),h=a.i(36361),i=a.i(1269);let j=(0,i.default)("receipt",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1Z",key:"q3az6g"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17.5v-11",key:"1jc1ny"}]]);var k=a.i(98888),l=a.i(56603),m=a.i(10734),n=a.i(74091);let o=(0,i.default)("coins",[["circle",{cx:"8",cy:"8",r:"6",key:"3yglwk"}],["path",{d:"M18.09 10.37A6 6 0 1 1 10.34 18",key:"t5s6rm"}],["path",{d:"M7 6h1v4",key:"1obek4"}],["path",{d:"m16.71 13.88.7.71-2.82 2.82",key:"1rbuyh"}]]),p=(0,i.default)("credit-card",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);async function q(){let a=await (0,d.createClient)(),{data:{user:i}}=await a.auth.getUser();i||(0,c.redirect)("/login");let q=(0,e.createClient)("https://fjghhrubobqwplvokszz.supabase.co",process.env.SUPABASE_SERVICE_ROLE_KEY),{data:r}=await q.from("profiles").select("role, account_type").eq("id",i.id).single();r?.role==="customer"&&(0,c.redirect)("/customer/dashboard");let s=r?.account_type==="super_customer",t=[];if(s){let{data:a}=await q.from("vending_machines").select("id").eq("customer_id",i.id);t=a?.map(a=>a.id)||[]}let u=q.from("vending_machines"),v=s?u.select("*",{count:"exact",head:!0}).eq("customer_id",i.id):u.select("*",{count:"exact",head:!0}),[{count:w},{count:x},{count:y},{count:z},{data:A},{data:B},{data:C},{data:D},{data:E}]=await Promise.all([v,q.from("profiles").select("*",{count:"exact",head:!0}).eq("role","customer"),s&&t.length>0?q.from("transactions").select("*",{count:"exact",head:!0}).in("machine_id",t):q.from("transactions").select("*",{count:"exact",head:!0}),s&&t.length>0?q.from("coin_payments").select("*",{count:"exact",head:!0}).in("machine_id",t):q.from("coin_payments").select("*",{count:"exact",head:!0}),s?q.from("vending_machines").select("name, location").eq("customer_id",i.id).order("created_at",{ascending:!1}).limit(3):q.from("vending_machines").select("name, location").order("created_at",{ascending:!1}).limit(3),s&&t.length>0?q.from("transactions").select("total_amount, created_at, items").in("machine_id",t).order("created_at",{ascending:!1}).limit(3):q.from("transactions").select("total_amount, created_at, items").order("created_at",{ascending:!1}).limit(3),s&&t.length>0?q.from("transactions").select("total_amount").eq("payment_status","paid").in("machine_id",t):q.from("transactions").select("total_amount").eq("payment_status","paid"),s&&t.length>0?q.from("coin_payments").select("amount_in_paisa, dispensed").in("machine_id",t):q.from("coin_payments").select("amount_in_paisa, dispensed"),q.from("products").select("id, name, sku, price").order("created_at",{ascending:!1})]),F=C?.reduce((a,b)=>a+parseFloat(b.total_amount||0),0)||0,G=(D?.reduce((a,b)=>a+(b.amount_in_paisa||0),0)||0)/100,H=F+G;return(0,b.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,b.jsx)("header",{className:"bg-white border-b",children:(0,b.jsxs)("div",{className:"px-6 py-4",children:[(0,b.jsxs)("nav",{className:"flex space-x-1 mb-4",children:[(0,b.jsx)("a",{href:"/admin/machines",className:"px-4 py-2 rounded-lg font-medium text-gray-600 hover:bg-gray-100 transition-colors",children:(0,b.jsxs)("span",{className:"flex items-center gap-2",children:[(0,b.jsx)(f.Building2,{className:"w-4 h-4"}),"Machines"]})}),(0,b.jsx)("a",{href:"/admin/products",className:"px-4 py-2 rounded-lg font-medium text-gray-600 hover:bg-gray-100 transition-colors",children:(0,b.jsxs)("span",{className:"flex items-center gap-2",children:[(0,b.jsx)(j,{className:"w-4 h-4"}),"Products"]})}),(0,b.jsx)("a",{href:"/admin/organizations",className:"px-4 py-2 rounded-lg font-medium text-gray-600 hover:bg-gray-100 transition-colors",children:(0,b.jsxs)("span",{className:"flex items-center gap-2",children:[(0,b.jsx)(f.Building2,{className:"w-4 h-4"}),"Organizations"]})}),(0,b.jsx)("a",{href:"/admin/users",className:"px-4 py-2 rounded-lg font-medium text-gray-600 hover:bg-gray-100 transition-colors",children:(0,b.jsxs)("span",{className:"flex items-center gap-2",children:[(0,b.jsx)(g.Users,{className:"w-4 h-4"}),"Users"]})}),(0,b.jsx)("a",{href:"/admin/transactions",className:"px-4 py-2 rounded-lg font-medium text-gray-600 hover:bg-gray-100 transition-colors",children:(0,b.jsxs)("span",{className:"flex items-center gap-2",children:[(0,b.jsx)(n.Activity,{className:"w-4 h-4"}),"Transactions"]})}),(0,b.jsx)("a",{href:"/admin/billing",className:"px-4 py-2 rounded-lg font-medium text-gray-600 hover:bg-gray-100 transition-colors",children:(0,b.jsxs)("span",{className:"flex items-center gap-2",children:[(0,b.jsx)(p,{className:"w-4 h-4"}),"Org Billing"]})}),(0,b.jsx)("a",{href:"/admin/analytics",className:"px-4 py-2 rounded-lg font-medium text-gray-600 hover:bg-gray-100 transition-colors",children:(0,b.jsxs)("span",{className:"flex items-center gap-2",children:[(0,b.jsx)(h.TrendingUp,{className:"w-4 h-4"}),"Analytics"]})})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Dashboard"}),(0,b.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"Welcome back! Here's what's happening today."})]}),(0,b.jsx)("form",{action:"/api/auth/logout",method:"POST",children:(0,b.jsx)("button",{type:"submit",className:"px-4 py-2 text-sm font-medium text-white bg-gradient-to-r from-red-500 to-red-600 hover:from-red-600 hover:to-red-700 rounded-lg transition-all shadow-sm",children:"Logout"})})]})]})}),(0,b.jsxs)("main",{className:"container mx-auto px-6 py-8",children:[(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[(0,b.jsx)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6 hover:shadow-md transition-shadow",children:(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)("div",{className:"p-3 bg-blue-100 rounded-lg",children:(0,b.jsx)(f.Building2,{className:"w-6 h-6 text-blue-600"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-sm text-gray-600 mb-1",children:"Total Machines"}),(0,b.jsx)("div",{className:"text-3xl font-bold text-gray-900",children:w||0})]})]})}),(0,b.jsx)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6 hover:shadow-md transition-shadow",children:(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)("div",{className:"p-3 bg-purple-100 rounded-lg",children:(0,b.jsx)(g.Users,{className:"w-6 h-6 text-purple-600"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-sm text-gray-600 mb-1",children:"Active Users"}),(0,b.jsx)("div",{className:"text-3xl font-bold text-gray-900",children:x||0})]})]})}),(0,b.jsx)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6 hover:shadow-md transition-shadow",children:(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)("div",{className:"p-3 bg-green-100 rounded-lg",children:(0,b.jsx)(h.TrendingUp,{className:"w-6 h-6 text-green-600"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-sm text-gray-600 mb-1",children:"Total Revenue"}),(0,b.jsxs)("div",{className:"text-3xl font-bold text-gray-900",children:["₹",H.toFixed(2)]})]})]})}),(0,b.jsx)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6 hover:shadow-md transition-shadow",children:(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)("div",{className:"p-3 bg-orange-100 rounded-lg",children:(0,b.jsx)(j,{className:"w-6 h-6 text-orange-600"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-sm text-gray-600 mb-1",children:"Transactions"}),(0,b.jsx)("div",{className:"text-3xl font-bold text-gray-900",children:(y||0)+(z||0)})]})]})})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[(0,b.jsx)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6 hover:shadow-md transition-shadow",children:(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)("div",{className:"p-3 bg-amber-100 rounded-lg",children:(0,b.jsx)(o,{className:"w-6 h-6 text-amber-600"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-sm text-gray-600 mb-1",children:"Coin Transactions"}),(0,b.jsx)("div",{className:"text-2xl font-bold text-gray-900",children:z||0}),(0,b.jsxs)("div",{className:"text-xs text-gray-500 mt-1",children:["₹",G.toFixed(2)]})]})]})}),(0,b.jsx)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6 hover:shadow-md transition-shadow",children:(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)("div",{className:"p-3 bg-blue-100 rounded-lg",children:(0,b.jsx)(p,{className:"w-6 h-6 text-blue-600"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-sm text-gray-600 mb-1",children:"Online Transactions"}),(0,b.jsx)("div",{className:"text-2xl font-bold text-gray-900",children:y||0}),(0,b.jsxs)("div",{className:"text-xs text-gray-500 mt-1",children:["₹",F.toFixed(2)]})]})]})}),(0,b.jsx)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6 hover:shadow-md transition-shadow",children:(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)("div",{className:"p-3 bg-yellow-100 rounded-lg",children:(0,b.jsx)(h.TrendingUp,{className:"w-6 h-6 text-yellow-600"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-sm text-gray-600 mb-1",children:"Coin Revenue %"}),(0,b.jsxs)("div",{className:"text-2xl font-bold text-gray-900",children:[H>0?(G/H*100).toFixed(1):"0","%"]}),(0,b.jsx)("div",{className:"text-xs text-gray-500 mt-1",children:"of total revenue"})]})]})}),(0,b.jsx)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6 hover:shadow-md transition-shadow",children:(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)("div",{className:"p-3 bg-indigo-100 rounded-lg",children:(0,b.jsx)(h.TrendingUp,{className:"w-6 h-6 text-indigo-600"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-sm text-gray-600 mb-1",children:"Online Revenue %"}),(0,b.jsxs)("div",{className:"text-2xl font-bold text-gray-900",children:[H>0?(F/H*100).toFixed(1):"0","%"]}),(0,b.jsx)("div",{className:"text-xs text-gray-500 mt-1",children:"of total revenue"})]})]})})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,b.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:[(0,b.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,b.jsxs)("h2",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[(0,b.jsx)(f.Building2,{className:"w-5 h-5 text-blue-600"}),"Recent Machines"]})}),(0,b.jsx)("div",{className:"divide-y divide-gray-100",children:A&&A.length>0?A.map((a,c)=>(0,b.jsx)("div",{className:"px-6 py-4 hover:bg-gray-50 transition-colors",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("div",{className:"font-semibold text-gray-900",children:a.name}),(0,b.jsxs)("div",{className:"text-sm text-gray-500 flex items-center gap-1 mt-1",children:[(0,b.jsx)(k.MapPin,{className:"w-3 h-3"}),a.location]})]}),(0,b.jsx)("div",{className:"flex items-center gap-2",children:(0,b.jsxs)("span",{className:"px-3 py-1 bg-green-100 text-green-700 rounded-full text-xs font-medium flex items-center gap-1",children:[(0,b.jsx)(m.CheckCircle2,{className:"w-3 h-3"}),"Online"]})})]})},c)):(0,b.jsxs)("div",{className:"px-6 py-12 text-center text-gray-400",children:[(0,b.jsx)(f.Building2,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),(0,b.jsx)("p",{children:"No machines found"})]})})]}),(0,b.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:[(0,b.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,b.jsxs)("h2",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[(0,b.jsx)(j,{className:"w-5 h-5 text-purple-600"}),"Recent Transactions"]})}),(0,b.jsx)("div",{className:"divide-y divide-gray-100",children:B&&B.length>0?B.map((a,c)=>{let d=("string"==typeof a.items?JSON.parse(a.items):a.items||[]).map(a=>a.name).join(", ")||"Product";return(0,b.jsx)("div",{className:"px-6 py-4 hover:bg-gray-50 transition-colors",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("div",{className:"font-semibold text-gray-900",children:d}),(0,b.jsxs)("div",{className:"text-sm text-gray-500 flex items-center gap-1 mt-1",children:[(0,b.jsx)(l.Clock,{className:"w-3 h-3"}),new Date(a.created_at).toLocaleTimeString()]})]}),(0,b.jsx)("div",{className:"text-right",children:(0,b.jsxs)("div",{className:"text-lg font-bold text-gray-900",children:["₹",parseFloat(a.total_amount||0).toFixed(2)]})})]})},c)}):(0,b.jsxs)("div",{className:"px-6 py-12 text-center text-gray-400",children:[(0,b.jsx)(j,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),(0,b.jsx)("p",{children:"No transactions found"})]})})]})]})]})]})}a.s(["default",()=>q],84063)}];

//# sourceMappingURL=src_app_admin_dashboard_page_tsx_0201eb1f._.js.map