module.exports=[4720,a=>{"use strict";let b=(0,a.i(70106).default)("file-text",[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);a.s(["FileText",()=>b],4720)},25213,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(4720),e=a.i(96221),f=a.i(5050),g=(0,f.createServerReference)("00fd2ddc5f28a9bffb78a1b615c92f26d0222f7fd2",f.callServer,void 0,f.findSourceMapURL,"generateMonthlyInvoices");function h(){let[a,f]=(0,c.useState)(!1),[h,i]=(0,c.useState)(null),j=async()=>{if(confirm("This will generate invoices for all organizations for the previous month. Continue?")){f(!0),i(null);try{let a=await g();if(a.success){let b=a.results?.filter(a=>a.success).length||0,c=a.results?.length||0;i(`Successfully generated ${b} out of ${c} invoices`),setTimeout(()=>window.location.reload(),2e3)}}catch(a){i(`Error: ${a.message}`)}finally{f(!1)}}};return(0,b.jsxs)("div",{children:[(0,b.jsxs)("button",{onClick:j,disabled:a,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed",children:[a?(0,b.jsx)(e.Loader2,{className:"h-4 w-4 animate-spin"}):(0,b.jsx)(d.FileText,{className:"h-4 w-4"}),"Generate Monthly Invoices"]}),h&&(0,b.jsx)("div",{className:`mt-2 text-sm ${h.startsWith("Error")?"text-red-600":"text-green-600"}`,children:h})]})}a.s(["GenerateMonthlyInvoicesButton",()=>h],25213)},50850,a=>{"use strict";var b=a.i(87924),c=a.i(72131);let d=(0,a.i(70106).default)("indian-rupee",[["path",{d:"M6 3h12",key:"ggurg9"}],["path",{d:"M6 8h12",key:"6g4wlu"}],["path",{d:"m6 13 8.5 8",key:"u1kupk"}],["path",{d:"M6 13h3",key:"wdp6ag"}],["path",{d:"M9 13c6.667 0 6.667-10 0-10",key:"1nkvk2"}]]);var e=a.i(33508),f=a.i(5050),g=(0,f.createServerReference)("4030285a2c3f1443a5a4c8c58c4e1bb7b61a63febb",f.callServer,void 0,f.findSourceMapURL,"recordManualPayment");function h({invoiceId:a,amountDue:f,organizationName:h}){let[i,j]=(0,c.useState)(!1),[k,l]=(0,c.useState)((f/100).toFixed(2)),[m,n]=(0,c.useState)(""),[o,p]=(0,c.useState)(!1),q=async b=>{b.preventDefault(),p(!0);try{let b=Math.round(100*parseFloat(k));(await g({invoiceId:a,amountPaisa:b,notes:m||void 0})).success&&(alert("Payment recorded successfully!"),j(!1),window.location.reload())}catch(a){alert(`Error: ${a.message}`)}finally{p(!1)}};return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("button",{onClick:()=>j(!0),className:"p-2 text-green-600 hover:bg-green-50 rounded-lg transition-colors",title:"Record Payment",children:(0,b.jsx)(d,{className:"h-4 w-4"})}),i&&(0,b.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,b.jsxs)("div",{className:"bg-white rounded-xl shadow-xl max-w-md w-full mx-4",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between p-6 border-b",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Record Payment"}),(0,b.jsx)("button",{onClick:()=>j(!1),className:"p-2 hover:bg-gray-100 rounded-lg",children:(0,b.jsx)(e.X,{className:"h-5 w-5 text-gray-500"})})]}),(0,b.jsxs)("form",{onSubmit:q,className:"p-6 space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Organization"}),(0,b.jsx)("input",{type:"text",value:h,disabled:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50 text-gray-700"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Amount (₹)"}),(0,b.jsx)("input",{type:"number",step:"0.01",min:"0",max:f/100,value:k,onChange:a=>l(a.target.value),required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),(0,b.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:["Amount due: ₹",(f/100).toFixed(2)]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes (Optional)"}),(0,b.jsx)("textarea",{value:m,onChange:a=>n(a.target.value),rows:3,placeholder:"Payment reference, transaction ID, etc.",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),(0,b.jsxs)("div",{className:"flex gap-3 pt-4",children:[(0,b.jsx)("button",{type:"button",onClick:()=>j(!1),className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),(0,b.jsx)("button",{type:"submit",disabled:o,className:"flex-1 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed",children:o?"Recording...":"Record Payment"})]})]})]})})]})}a.s(["RecordPaymentButton",()=>h],50850)},1362,a=>{"use strict";var b=a.i(87924);let c=(0,a.i(70106).default)("circle-check",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);var d=a.i(33508),e=a.i(72131),f=a.i(50944);function g(){let[a,g]=(0,e.useState)(!0),h=(0,f.useRouter)();(0,e.useEffect)(()=>{let a=setTimeout(()=>{i()},1e4);return()=>clearTimeout(a)},[]);let i=()=>{g(!1),h.replace("/admin/billing")};return a?(0,b.jsx)("div",{className:"fixed top-4 left-1/2 transform -translate-x-1/2 z-50 w-full max-w-md",children:(0,b.jsx)("div",{className:"bg-green-50 border-2 border-green-200 rounded-lg shadow-lg p-4 mx-4",children:(0,b.jsxs)("div",{className:"flex items-start gap-3",children:[(0,b.jsx)("div",{className:"flex-shrink-0",children:(0,b.jsx)(c,{className:"h-6 w-6 text-green-600"})}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("h3",{className:"text-green-900 font-semibold mb-1",children:"Payment Successful!"}),(0,b.jsx)("p",{className:"text-green-700 text-sm",children:"Your payment has been received and the invoice has been marked as paid. Amount due is now ₹0.00."})]}),(0,b.jsx)("button",{onClick:i,className:"flex-shrink-0 text-green-600 hover:text-green-800",children:(0,b.jsx)(d.X,{className:"h-5 w-5"})})]})})}):null}a.s(["PaymentSuccessBanner",()=>g],1362)},8618,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(4720),e=a.i(33508);function f(){let[a,f]=(0,c.useState)(!1),[g,h]=(0,c.useState)([]),[i,j]=(0,c.useState)(""),[k,l]=(0,c.useState)(""),[m,n]=(0,c.useState)(""),[o,p]=(0,c.useState)(!1),[q,r]=(0,c.useState)("");(0,c.useEffect)(()=>{if(a){s();let a=new Date,b=new Date(a.getFullYear(),a.getMonth(),1),c=new Date(a.getFullYear(),a.getMonth()+1,0);l(b.toISOString().split("T")[0]),n(c.toISOString().split("T")[0])}},[a]);let s=async()=>{try{let a=await fetch("/api/billing/organizations");if(a.ok){let b=await a.json();h(b.organizations||[])}}catch(a){console.error("Error fetching organizations:",a)}},t=async()=>{if(!i||!k||!m)return void r("Please fill in all fields");p(!0),r("");try{let a=await fetch("/api/billing/generate-invoice",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({organizationId:i,periodStart:new Date(k).toISOString(),periodEnd:new Date(m+"T23:59:59").toISOString()})}),b=await a.json();a.ok?(r(`✅ Invoice ${b.invoice.invoice_number} generated successfully!`),setTimeout(()=>{f(!1),window.location.reload()},2e3)):r(`❌ ${b.error||"Failed to generate invoice"}`)}catch(a){r(`❌ ${a.message||"An error occurred"}`)}finally{p(!1)}};return a?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-40",onClick:()=>f(!1)}),(0,b.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:(0,b.jsxs)("div",{className:"bg-white rounded-xl shadow-xl max-w-md w-full p-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,b.jsx)("h2",{className:"text-xl font-bold text-gray-900",children:"Generate Invoice"}),(0,b.jsx)("button",{onClick:()=>f(!1),className:"text-gray-400 hover:text-gray-600",children:(0,b.jsx)(e.X,{size:24})})]}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Organization"}),(0,b.jsxs)("select",{value:i,onChange:a=>j(a.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:o,children:[(0,b.jsx)("option",{value:"",children:"Select organization..."}),g.map(a=>(0,b.jsx)("option",{value:a.id,children:a.name},a.id))]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Period Start"}),(0,b.jsx)("input",{type:"date",value:k,onChange:a=>l(a.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:o})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Period End"}),(0,b.jsx)("input",{type:"date",value:m,onChange:a=>n(a.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:o})]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)("button",{onClick:()=>{let a=new Date,b=new Date(a.getFullYear(),a.getMonth(),1),c=new Date(a.getFullYear(),a.getMonth()+1,0);l(b.toISOString().split("T")[0]),n(c.toISOString().split("T")[0])},className:"text-xs px-3 py-1.5 bg-blue-50 text-blue-700 rounded hover:bg-blue-100",disabled:o,children:"This Month"}),(0,b.jsx)("button",{onClick:()=>{let a=new Date,b=new Date(a.getFullYear(),a.getMonth()-1,1),c=new Date(a.getFullYear(),a.getMonth(),0);l(b.toISOString().split("T")[0]),n(c.toISOString().split("T")[0])},className:"text-xs px-3 py-1.5 bg-gray-50 text-gray-700 rounded hover:bg-gray-100",disabled:o,children:"Last Month"})]}),q&&(0,b.jsx)("div",{className:`p-3 rounded-lg text-sm ${q.startsWith("✅")?"bg-green-50 text-green-800":"bg-red-50 text-red-800"}`,children:q}),(0,b.jsxs)("div",{className:"flex gap-3 pt-4",children:[(0,b.jsx)("button",{onClick:t,disabled:o||!i||!k||!m,className:"flex-1 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed font-medium",children:o?"Generating...":"Generate Invoice"}),(0,b.jsx)("button",{onClick:()=>f(!1),disabled:o,className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 text-gray-700",children:"Cancel"})]})]})]})})]}):(0,b.jsxs)("button",{onClick:()=>f(!0),className:"inline-flex items-center gap-2 px-4 py-2 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 text-gray-700",children:[(0,b.jsx)(d.FileText,{size:16}),"Generate Manual Invoice"]})}a.s(["ManualInvoiceGenerator",()=>f])},48415,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(81560);let e=(0,a.i(70106).default)("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);var f=a.i(5050),g=(0,f.createServerReference)("40a7f73406654a2374577af0091523566d6b043190",f.callServer,void 0,f.findSourceMapURL,"deleteInvoice"),h=a.i(50944);function i({invoiceId:a,invoiceNumber:f,organizationName:i}){let[j,k]=(0,c.useState)(!1),[l,m]=(0,c.useState)(!1),[n,o]=(0,c.useState)(null),p=(0,h.useRouter)(),q=async()=>{try{m(!0),o(null),await g(a),k(!1),m(!1),p.refresh()}catch(a){o(a instanceof Error?a.message:"Failed to delete invoice"),m(!1)}};return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("button",{onClick:()=>k(!0),className:"inline-flex items-center gap-1.5 px-3 py-1.5 bg-red-600 text-white text-xs font-medium rounded hover:bg-red-700 disabled:opacity-50",disabled:l,children:[(0,b.jsx)(d.Trash2,{className:"h-3.5 w-3.5"}),"Delete"]}),j&&(0,b.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",onClick:()=>k(!1),children:(0,b.jsx)("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-2xl mx-4",onClick:a=>a.stopPropagation(),children:(0,b.jsxs)("div",{className:"p-6",children:[(0,b.jsxs)("div",{className:"flex items-start gap-4 mb-4",children:[(0,b.jsx)("div",{className:"p-3 bg-red-100 rounded-full flex-shrink-0",children:(0,b.jsx)(e,{className:"h-6 w-6 text-red-600"})}),(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Delete Invoice?"}),(0,b.jsxs)("p",{className:"text-sm text-gray-600 mb-2",style:{wordBreak:"break-word",overflowWrap:"break-word"},children:["Are you sure you want to delete invoice ",(0,b.jsx)("strong",{children:f})," for ",(0,b.jsx)("strong",{children:i}),"?"]}),(0,b.jsx)("p",{className:"text-sm text-red-600 font-medium",style:{wordBreak:"break-word",overflowWrap:"break-word"},children:"This action cannot be undone. All associated payment records will also be deleted."})]})]}),n&&(0,b.jsx)("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:(0,b.jsx)("p",{className:"text-sm text-red-600 break-words",children:n})}),(0,b.jsxs)("div",{className:"flex items-center justify-end gap-3 pt-2",children:[(0,b.jsx)("button",{onClick:()=>{k(!1),o(null)},className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200",disabled:l,children:"Cancel"}),(0,b.jsx)("button",{onClick:q,className:"px-4 py-2 text-sm font-medium text-white bg-red-600 rounded-lg hover:bg-red-700 disabled:opacity-50",disabled:l,children:l?"Deleting...":"Delete Invoice"})]})]})})})]})}a.s(["DeleteInvoiceButton",()=>i],48415)}];

//# sourceMappingURL=_0a1d64fd._.js.map